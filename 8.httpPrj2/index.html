<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>我的首页</title>
    <link href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">

</head>
<body>

<div class="container" style="margin-top: 20px;">


    <ul class="nav nav-tabs">
        <li role="presentation" class="active"><a href="#">列表页</a></li>
        <li role="presentation"><a href="#">添加</a></li>
        <li role="presentation"><a href="#">修改</a></li>
    </ul>

    <div class="panel panel-primary" style="margin-top: 20px;">
        <div class="panel-heading">用户列表</div>
        <div class="panel-body">
            <table class="table table-bordered text-center">
                <thead>
                <tr>
                    <th class="text-center">id</th>
                    <th class="text-center">名字</th>
                    <th class="text-center">年龄</th>
                    <th class="text-center">性别</th>
                    <th class="text-center">操作</th>
                </tr>
                </thead>

                <tbody id="userList">

                </tbody>
            </table>


            <nav>
                <ul class="pagination">
                    <li><a href="javascript:getlist(1,10);">1</a></li>
                    <li><a href="javascript:getlist(2,10);">2</a></li>
                    <li><a href="javascript:getlist(3,10);">3</a></li>
                    <li><a href="javascript:getlist(4,10);">4</a></li>
                    <li><a href="javascript:getlist(5,10);">5</a></li>
                </ul>
            </nav>
        </div>

    </div>
</div>

<script>

    function getlist(page, size) {
        var xhr = new XMLHttpRequest();
        var url = "getList?page=" + page + "&Pagesize=" + size;
        xhr.open("GET", url, true);
        //打开异步对象
        xhr.onreadystatechange = function () {
            if (xhr.readyState == 4 && xhr.status == 200) {
                //console.log(result);
                var result = JSON.parse(xhr.responseText);
                //console.log(result);
                if (result.success == "ok") {
                    var str = "";
                    for (var i = 0; i < result.result.length; i++) {

                        str += "<tr id='user_" + result.result[i].id + "'>"
                        str += "<td>" + result.result[i].id + "</td>"
                        str += "<td>" + result.result[i].name + "</td>"
                        str += "<td>" + result.result[i].age + "</td>"
                        str += "<td>" + result.result[i].sex + "</td>"
                        str += "<td><a href='javascript:update(" + result.result[i].id + ");'>修改</a> <a href='javascript:delUser(" + result.result[i].id + ");'>删除</a></td>"
                        str += "</tr>"

                    }
                    document.querySelector("#userList").innerHTML = str;


                }
                else if (result.success == "no") {
                    document.querySelector("#userList").innerHTML = "<tr><td colspan='5'>" + result.error + "</td></tr> "
                }

            }

        }
        xhr.send();
    }

    getlist();


    function update(id) {
        console.log(id);
    }
    function delUser(id) {

        var str = "user_" + id;
        var oTr = document.getElementById(str);
        oTr.parentNode.removeChild(oTr)


    }
</script>

</body>
</html>